# skillet preamble information used by panhandler
# ---------------------------------------------------------------------
# unique snippet name
name: prisma_access_mobile_user_onboarding_v90
# label used for menu selection
label: Prisma Access Mobile User Setup v90
description: Prisma Access initial mobile user configuration prior to onboarding

# type of device configuration
# common types are panorama, panos, and template
# https://github.com/PaloAltoNetworks/panhandler/blob/develop/docs/metadata_configuration.rst
type: panorama-gpcs
# preload static or default-based templates
extends:

# grouping of like snippets for dynamic menu creation in panhandler
labels:
  collection:
    - Prisma Access

# ---------------------------------------------------------------------
# end of preamble section

# variables section
# ---------------------------------------------------------------------
# variables used in the configuration templates
# type_hint defines the form field used by panhandler
# type_hints can be text, ip_address, or dropdown
variables:
  - name: portal_hostname
    description: portal subdomain
    default: my-subdomain
    type_hint: text
    help_text: subdomain prefix for cloudservice.com
  - name: ip_pool_geo
    description: geo location for mobile users (TBD)
    default: worldwide
    type_hint: dropdown
    help_text: basic skillet setup uses a single geo selection with advanced configuration done in the Panorama UI
  - name: ip_pool_cidr
    description: mobile user IP address pool
    default: 192.168.2.0/24
    type_hint: cidr
    help_text: use a CIDR (/24) notation for pool entry. Only a single pool option with this skillet
  - name: deployment_region
    description: regional to use for mobile user configuration
    default: americas
    type_hint: dropdown
    dd_list:
      - key: worldwide
        value: worldwide
    # TODO: add in more dropdown options and link to locations
    help_text: skillet allows for selecting a single starter region. additional regions added in Panorama
    # TODO: figure out how to only show subset of locations AND map to snippets below based on region
  - name: deployment_locations_americas
    description: deployment location options for the Americas region
    default: US Southeast
    type_hint: checkbox
    # TODO: create list of locations per region with xml coded naming
    cbx_list:
      - key: US Southeast
        value: region 2
    help_text: use a CIDR (/24) notation for pool entry. Only a single pool option with this skillet

# ---------------------------------------------------------------------
# end of variables section

# snippets section
# ---------------------------------------------------------------------
# snippets used for api configuration including xpath and element as file name
# files will load in the order listed
# NOTE: The following snippets are auto-generated and ordered automatically.
# Changing the content of the snippet may be necessary, but do NOT change the order

# There is a variable called snippets that we can use to auto-generate this section for us
snippets:

  - name: mobile_user_auth_profile
    xpath: /config/devices/entry[@name="localhost.localdomain"]/template/entry[@name="Mobile_User_Template"]/config/devices/entry[@name="localhost.localdomain"]/vsys/entry[@name="vsys1"]
    element: |-
      <authentication-profile>
        <entry name="Local-DB">
          <multi-factor-auth>
            <mfa-enable>no</mfa-enable>
          </multi-factor-auth>
          <method>
            <local-database/>
          </method>
          <allow-list>
            <member>all</member>
          </allow-list>
        </entry>
      </authentication-profile>

  - name: mobile_users_plugin_configuration
    xpath: /config/devices/entry[@name="localhost.localdomain"]/plugins/cloud_services[@version="1.5.0"]/mobile-users
    element: |-
      <onboarding>
        <entry name="{{ portal_hostname }}.gpcloudservice.com">
          <portal-hostname>
            <default-domain>
              <hostname>{{ portal_hostname }}</hostname>
            </default-domain>
          </portal-hostname>
          <ip-pools>
            <entry name="{{ ip_pool_geo }}">
              <ip-pool>
                <member>{{ ip_pool_cidr }}</member>
              </ip-pool>
            </entry>
          </ip-pools>
          <dns-servers>
            <entry name="{{ ip_pool_geo }}"/>
          </dns-servers>
          <authentication-profile>Local-DB</authentication-profile>
          <authentication-override-certificate>Authentication Cookie Cert</authentication-override-certificate>
          <global-protect-portal>GlobalProtect_Portal</global-protect-portal>
          <global-protect-gateway>GlobalProtect_External_Gateway</global-protect-gateway>
          <deployment>
            <region>
              <entry name="{{ deployment_region }}">
                <locations>
                  {%- for location in locations %}
                  <member>{{ deployment_location }}</member>
                  {% endfor %}
                </locations>
              </entry>
            </region>
          </deployment>
          <manual-gateway>
            <region>
              <entry name="{{ deployment_region }}">
                <locations>
                  {%- for location in locations %}
                  <member>{{ deployment_location }}</member>
                  {% endfor %}
                </locations>
              </entry>
            </region>
          </manual-gateway>
        </entry>
      </onboarding>

 - name: mobile_user_cert_01
    xpath: /config/devices/entry[@name="localhost.localdomain"]/template/entry[@name="Mobile_User_Template"]/config/shared
    element: |-
        <certificate>
                        <entry name="Authentication Cookie CA">
                          <subject-hash>58b6369c</subject-hash>
                          <issuer-hash>58b6369c</issuer-hash>
                          <not-valid-before>Mar 18 17:33:56 2020 GMT</not-valid-before>
                          <issuer>/CN=Authentication Cookie CA</issuer>
                          <not-valid-after>Mar 16 17:33:56 2030 GMT</not-valid-after>
                          <common-name>Authentication Cookie CA</common-name>
                          <expiry-epoch>1899912836</expiry-epoch>
                          <ca>yes</ca>
                          <subject>/CN=Authentication Cookie CA</subject>
                          <public-key>-----BEGIN CERTIFICATE-----
        MIIC5jCCAc6gAwIBAgIJAOygjXimyCg2MA0GCSqGSIb3DQEBCwUAMCMxITAfBgNV
        BAMTGEF1dGhlbnRpY2F0aW9uIENvb2tpZSBDQTAeFw0yMDAzMTgxNzMzNTZaFw0z
        MDAzMTYxNzMzNTZaMCMxITAfBgNVBAMTGEF1dGhlbnRpY2F0aW9uIENvb2tpZSBD
        QTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDQDPW6iDpysR7pUD7G
        9BJX4qUmJqsNWNAhxJsRmeGKHhqD4z85VrQmialD4UQ6sTnI48BHZAMYaUGFkq0v
        oChsnXS0Hmif+zzYh+85qkerUTQjW9SxZIHUrHFfoZfDA1PVd2kzcBHfA9b3eJek
        0fqYD9XI9QiSqky8jaQRooFe98llAD275FWPPxxiyYCr0lB/cYoWxeRvx0OsWwGa
        vghIBam9cT1t/z0fdfGVL+viNUEva/to1IswtuVHFYLy61csiJviyv4xzc/b02jk
        KDJtjZaijNiPhLd+KRdvnzZ1G5v6SZmSh9OHY/geasS2DgYjazcv/jPK7XR7WwyT
        cUUCAwEAAaMdMBswDAYDVR0TBAUwAwEB/zALBgNVHQ8EBAMCAgQwDQYJKoZIhvcN
        AQELBQADggEBAL0RGpBwuh9lxg8lVWZruzcvDlUCZ8L4kecvJ0FBBpM1YTDmKfHu
        X4BbTEAUf1pt+jKSztibTpfqQCf6LSDY4Yt3iIVd0H0TfM/oJyIzxBQue9wWFhvA
        hsh5h0RvsxmheLhbS0vle4Ji4jScLzXu8h1BXBbvDnpd53tvSNbGROVODwYTlBsh
        g2/FqxoUGu6Senu22l56j6FqZ5/aWkxf9ONLXXvhiZDpNBHFzMMFIboIBhvNZgUN
        4+rYGTZ8wlL4RyiuI8bEHzy1skDIvNOiWXJn6Xcm2dcWPSN/Hnq+y+DCevJjxv5u
        fY6wJmfUmr8SstjC5B094v6kdCH3rko8ZZg=
        -----END CERTIFICATE-----
        </public-key>
                          <algorithm>RSA</algorithm>
                          <private-key>-AQ==ipSf6s0AkoMhJc8bjcXKAFtk2ZM=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</private-key>
                        </entry>
                        <entry name="Authentication Cookie Cert">
                          <subject-hash>250129f3</subject-hash>
                          <issuer-hash>58b6369c</issuer-hash>
                          <not-valid-before>Mar 18 17:33:57 2020 GMT</not-valid-before>
                          <issuer>/CN=Authentication Cookie CA</issuer>
                          <not-valid-after>Mar 18 17:33:57 2022 GMT</not-valid-after>
                          <common-name>Authentication Cookie Cert</common-name>
                          <expiry-epoch>1647624837</expiry-epoch>
                          <ca>no</ca>
                          <subject>/CN=Authentication Cookie Cert</subject>
                          <public-key>-----BEGIN CERTIFICATE-----
        MIIDNDCCAhygAwIBAgIFAJaRTsEwDQYJKoZIhvcNAQELBQAwIzEhMB8GA1UEAxMY
        QXV0aGVudGljYXRpb24gQ29va2llIENBMB4XDTIwMDMxODE3MzM1N1oXDTIyMDMx
        ODE3MzM1N1owJTEjMCEGA1UEAxMaQXV0aGVudGljYXRpb24gQ29va2llIENlcnQw
        ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC9JEvWvjAPJPE4SnLzi9jU
        oZl8kkxw/GXznDTRXahnk4e5fBsBs57pRr8rgbyF6kGjX7uUKsSoGgPF87MkPpXr
        g9tPSkr9+KGxSK5JatQE6ozUmr56s6/e4nCCTNCN3ruBt3m0KUzObzImaHvq2sIp
        5/fbKTGKK/MiBsQy8xeo2x+Ju/rKi8yCQ21qXO/Uy/BmgsO9a0zFvi1nckk4FFp3
        h6KuXp7To/PiVC+I+pv/5ZhPdh7RBf+zBsto/OS6TaeyK/HU0Kq2ksF0bfHMKlbK
        zNFWuIEDHlqs6HWim8bWEr6mjETHqqqBpapI2NLbCEbv9Ewoo4D/6U6teJgVV5Yb
        AgMBAAGjbTBrMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgO4MCcGA1UdJQQgMB4GCCsG
        AQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwUwCQYDVR0jBAIwADAdBgNVHQ4EFgQU
        i4Lbuig2v8XGhaiWWg+PTyZMA5IwDQYJKoZIhvcNAQELBQADggEBALmaqmalNPxj
        mJYjEaGpMl3UpGfP6PKxaBctkOuv1YAqAZgflb3qMO6MLLVv1O8CThTpxJA1jjEJ
        1C3AcGPVfSIqvfZtg62LKMWir5pp0d1h0PyJ1OgOaJwJJZJwTNIZExQ5K18Ox15P
        +uGaSRWreTeb7S+m773pf+AjhCQ1PVXfum260VR7j0WRW/rK94uZDUJko5nZ6thk
        bK3mCaDWvYTxziwUMwt5RP5x439RcvVmAEfs0x2nNWMMpJRaNQvCZuPbld6gn89L
        ywJi2mNuj5Kc3N+wgEqFP3XHSQqhLipm0hWhA4gdk9AFyGYIGUHrWA4yoRXiQE+V
        x0S2jS+SkLU=
        -----END CERTIFICATE-----
        </public-key>
                          <algorithm>RSA</algorithm>
                          <private-key>-AQ==SWzvHYEWfLqCSXIH9IydNOfaxWQ=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</private-key>
                        </entry>
                      </certificate>

  - name: mobile_user_cert_02
    xpath: /config/devices/entry[@name="localhost.localdomain"]/template/entry[@name="Mobile_User_Template"]/config/shared
    element: |-
        <certificate>
                        <entry name="Authentication Cookie CA">
                          <subject-hash>58b6369c</subject-hash>
                          <issuer-hash>58b6369c</issuer-hash>
                          <not-valid-before>Mar 18 17:33:56 2020 GMT</not-valid-before>
                          <issuer>/CN=Authentication Cookie CA</issuer>
                          <not-valid-after>Mar 16 17:33:56 2030 GMT</not-valid-after>
                          <common-name>Authentication Cookie CA</common-name>
                          <expiry-epoch>1899912836</expiry-epoch>
                          <ca>yes</ca>
                          <subject>/CN=Authentication Cookie CA</subject>
                          <public-key>-----BEGIN CERTIFICATE-----
        MIIC5jCCAc6gAwIBAgIJAOygjXimyCg2MA0GCSqGSIb3DQEBCwUAMCMxITAfBgNV
        BAMTGEF1dGhlbnRpY2F0aW9uIENvb2tpZSBDQTAeFw0yMDAzMTgxNzMzNTZaFw0z
        MDAzMTYxNzMzNTZaMCMxITAfBgNVBAMTGEF1dGhlbnRpY2F0aW9uIENvb2tpZSBD
        QTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDQDPW6iDpysR7pUD7G
        9BJX4qUmJqsNWNAhxJsRmeGKHhqD4z85VrQmialD4UQ6sTnI48BHZAMYaUGFkq0v
        oChsnXS0Hmif+zzYh+85qkerUTQjW9SxZIHUrHFfoZfDA1PVd2kzcBHfA9b3eJek
        0fqYD9XI9QiSqky8jaQRooFe98llAD275FWPPxxiyYCr0lB/cYoWxeRvx0OsWwGa
        vghIBam9cT1t/z0fdfGVL+viNUEva/to1IswtuVHFYLy61csiJviyv4xzc/b02jk
        KDJtjZaijNiPhLd+KRdvnzZ1G5v6SZmSh9OHY/geasS2DgYjazcv/jPK7XR7WwyT
        cUUCAwEAAaMdMBswDAYDVR0TBAUwAwEB/zALBgNVHQ8EBAMCAgQwDQYJKoZIhvcN
        AQELBQADggEBAL0RGpBwuh9lxg8lVWZruzcvDlUCZ8L4kecvJ0FBBpM1YTDmKfHu
        X4BbTEAUf1pt+jKSztibTpfqQCf6LSDY4Yt3iIVd0H0TfM/oJyIzxBQue9wWFhvA
        hsh5h0RvsxmheLhbS0vle4Ji4jScLzXu8h1BXBbvDnpd53tvSNbGROVODwYTlBsh
        g2/FqxoUGu6Senu22l56j6FqZ5/aWkxf9ONLXXvhiZDpNBHFzMMFIboIBhvNZgUN
        4+rYGTZ8wlL4RyiuI8bEHzy1skDIvNOiWXJn6Xcm2dcWPSN/Hnq+y+DCevJjxv5u
        fY6wJmfUmr8SstjC5B094v6kdCH3rko8ZZg=
        -----END CERTIFICATE-----
        </public-key>
                          <algorithm>RSA</algorithm>
                          <private-key>-AQ==ipSf6s0AkoMhJc8bjcXKAFtk2ZM=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</private-key>
                        </entry>
                        <entry name="Authentication Cookie Cert">
                          <subject-hash>250129f3</subject-hash>
                          <issuer-hash>58b6369c</issuer-hash>
                          <not-valid-before>Mar 18 17:33:57 2020 GMT</not-valid-before>
                          <issuer>/CN=Authentication Cookie CA</issuer>
                          <not-valid-after>Mar 18 17:33:57 2022 GMT</not-valid-after>
                          <common-name>Authentication Cookie Cert</common-name>
                          <expiry-epoch>1647624837</expiry-epoch>
                          <ca>no</ca>
                          <subject>/CN=Authentication Cookie Cert</subject>
                          <public-key>-----BEGIN CERTIFICATE-----
        MIIDNDCCAhygAwIBAgIFAJaRTsEwDQYJKoZIhvcNAQELBQAwIzEhMB8GA1UEAxMY
        QXV0aGVudGljYXRpb24gQ29va2llIENBMB4XDTIwMDMxODE3MzM1N1oXDTIyMDMx
        ODE3MzM1N1owJTEjMCEGA1UEAxMaQXV0aGVudGljYXRpb24gQ29va2llIENlcnQw
        ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC9JEvWvjAPJPE4SnLzi9jU
        oZl8kkxw/GXznDTRXahnk4e5fBsBs57pRr8rgbyF6kGjX7uUKsSoGgPF87MkPpXr
        g9tPSkr9+KGxSK5JatQE6ozUmr56s6/e4nCCTNCN3ruBt3m0KUzObzImaHvq2sIp
        5/fbKTGKK/MiBsQy8xeo2x+Ju/rKi8yCQ21qXO/Uy/BmgsO9a0zFvi1nckk4FFp3
        h6KuXp7To/PiVC+I+pv/5ZhPdh7RBf+zBsto/OS6TaeyK/HU0Kq2ksF0bfHMKlbK
        zNFWuIEDHlqs6HWim8bWEr6mjETHqqqBpapI2NLbCEbv9Ewoo4D/6U6teJgVV5Yb
        AgMBAAGjbTBrMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgO4MCcGA1UdJQQgMB4GCCsG
        AQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwUwCQYDVR0jBAIwADAdBgNVHQ4EFgQU
        i4Lbuig2v8XGhaiWWg+PTyZMA5IwDQYJKoZIhvcNAQELBQADggEBALmaqmalNPxj
        mJYjEaGpMl3UpGfP6PKxaBctkOuv1YAqAZgflb3qMO6MLLVv1O8CThTpxJA1jjEJ
        1C3AcGPVfSIqvfZtg62LKMWir5pp0d1h0PyJ1OgOaJwJJZJwTNIZExQ5K18Ox15P
        +uGaSRWreTeb7S+m773pf+AjhCQ1PVXfum260VR7j0WRW/rK94uZDUJko5nZ6thk
        bK3mCaDWvYTxziwUMwt5RP5x439RcvVmAEfs0x2nNWMMpJRaNQvCZuPbld6gn89L
        ywJi2mNuj5Kc3N+wgEqFP3XHSQqhLipm0hWhA4gdk9AFyGYIGUHrWA4yoRXiQE+V
        x0S2jS+SkLU=
        -----END CERTIFICATE-----
        </public-key>
                          <algorithm>RSA</algorithm>
                          <private-key>-AQ==SWzvHYEWfLqCSXIH9IydNOfaxWQ=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</private-key>
                        </entry>
                      </certificate>

  - name: mobile_user_local_db
    xpath: /config/devices/entry[@name="localhost.localdomain"]/template/entry[@name="Mobile_User_Template"]/config/shared
    element: |-
      <local-user-database>
        <user>
          <entry name="User1">
            <phash>$1$vfanykcm$eETpQZAV27Dg122JHUuDt0</phash>
          </entry>
          <entry name="User2">
            <phash>$1$jwlcyrhv$Q6.LOkN1ULASmYeqdmCy91</phash>
          </entry>
        </user>
      </local-user-database>




  - name: mobile_user_portal
    xpath: /config/devices/entry[@name="localhost.localdomain"]/template/entry[@name="Mobile_User_Template"]/config/devices/entry[@name="localhost.localdomain"]/vsys/entry[@name="vsys1"]
    element: |-
      <global-protect>
        <global-protect-portal>
          <entry name="GlobalProtect_Portal">
            <portal-config>
              <local-address>
                <interface>-</interface>
                <ip/>
              </local-address>
              <ssl-tls-service-profile>-</ssl-tls-service-profile>
              <client-auth>
                <entry name="DEFAULT">
                  <os>Any</os>
                  <authentication-profile>Local-DB</authentication-profile>
                  <authentication-message>Enter login credentials</authentication-message>
                </entry>
              </client-auth>
              <custom-login-page>factory-default</custom-login-page>
              <custom-home-page>factory-default</custom-home-page>
            </portal-config>
            <client-config>
              <configs>
                <entry name="DEFAULT">
                  <gateways>
                    <external>
                      <list>
                        <entry name="GP cloud service">
                          <fqdn>gpcloudservice.com</fqdn>
                          <priority-rule>
                            <entry name="Any">
                              <priority>1</priority>
                            </entry>
                          </priority-rule>
                          <manual>yes</manual>
                        </entry>
                      </list>
                      <cutoff-time>5</cutoff-time>
                    </external>
                  </gateways>
                  <authentication-override>
                    <accept-cookie>
                      <cookie-lifetime>
                        <lifetime-in-hours>24</lifetime-in-hours>
                      </cookie-lifetime>
                    </accept-cookie>
                    <cookie-encrypt-decrypt-cert>Authentication Cookie Cert</cookie-encrypt-decrypt-cert>
                    <generate-cookie>yes</generate-cookie>
                  </authentication-override>
                  <source-user>
                    <member>any</member>
                  </source-user>
                  <os>
                    <member>any</member>
                  </os>
                </entry>
              </configs>
            </client-config>
            <clientless-vpn>
              <hostname>dell-prisma.gpcloudservice.com</hostname>
              <dns-proxy>CloudDefault</dns-proxy>
            </clientless-vpn>
          </entry>
        </global-protect-portal>
        <global-protect-gateway>
          <entry name="GlobalProtect_External_Gateway">
            <client-auth>
              <entry name="DEFAULT">
                <authentication-profile>Local-DB</authentication-profile>
                <os>Any</os>
              </entry>
            </client-auth>
            <remote-user-tunnel-configs>
              <entry name="DEFAULT">
                <authentication-override>
                  <accept-cookie>
                    <cookie-lifetime>
                      <lifetime-in-hours>24</lifetime-in-hours>
                    </cookie-lifetime>
                  </accept-cookie>
                  <cookie-encrypt-decrypt-cert>Authentication Cookie Cert</cookie-encrypt-decrypt-cert>
                  <generate-cookie>yes</generate-cookie>
                </authentication-override>
                <source-user>
                  <member>any</member>
                </source-user>
                <os>
                  <member>any</member>
                </os>
              </entry>
            </remote-user-tunnel-configs>
            <ssl-tls-service-profile>-</ssl-tls-service-profile>
            <tunnel-mode>yes</tunnel-mode>
            <remote-user-tunnel>-</remote-user-tunnel>
          </entry>
        </global-protect-gateway>
      </global-protect>

  - name: mobile_user_gateway
    xpath: /config/devices/entry[@name="localhost.localdomain"]/template/entry[@name="Mobile_User_Template"]/config/devices/entry[@name="localhost.localdomain"]
    element: |-
      <network>
        <tunnel>
          <global-protect-gateway>
            <entry name="GlobalProtect_External_Gateway-N">
              <local-address>
                <interface>-</interface>
                <ip/>
              </local-address>
              <tunnel-interface>-</tunnel-interface>
            </entry>
          </global-protect-gateway>
        </tunnel>
      </network>


  - name: mobile_user_dg_log_settings
    xpath: /config/devices/entry[@name="localhost.localdomain"]/device-group/entry[@name="Mobile_User_Device_Group"]/log-settings
    element: |-
      <profiles>
        <entry name="Mobile_Users_Log_Profile">
          <match-list>
            <entry name="traffic-enhanced-app-logging">
              <log-type>traffic</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="threat-enhanced-app-logging">
              <log-type>threat</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="wildfire-enhanced-app-logging">
              <log-type>wildfire</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="url-enhanced-app-logging">
              <log-type>url</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="data-enhanced-app-logging">
              <log-type>data</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="tunnel-enhanced-app-logging">
              <log-type>tunnel</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="auth-enhanced-app-logging">
              <log-type>auth</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
          <enhanced-application-logging>yes</enhanced-application-logging>
        </entry>
      </profiles>


  - name: mobile_user_dg_pre_security_rules
    xpath: /config/devices/entry[@name="localhost.localdomain"]/device-group/entry[@name="Mobile_User_Device_Group"]/pre-rulebasek/security/rules
    element: |-
      <entry name="MU-trust-to-MU-untrust">
        <profile-setting>
          <profiles>
            <url-filtering>
              <member>default</member>
            </url-filtering>
            <file-blocking>
              <member>basic file blocking</member>
            </file-blocking>
            <virus>
              <member>default</member>
            </virus>
            <spyware>
              <member>default</member>
            </spyware>
            <vulnerability>
              <member>default</member>
            </vulnerability>
            <wildfire-analysis>
              <member>default</member>
            </wildfire-analysis>
          </profiles>
        </profile-setting>
        <target>
          <negate>no</negate>
        </target>
        <to>
          <member>MU-untrust</member>
        </to>
        <from>
          <member>MU-trust</member>
        </from>
        <source>
          <member>any</member>
        </source>
        <destination>
          <member>any</member>
        </destination>
        <source-user>
          <member>any</member>
        </source-user>
        <category>
          <member>any</member>
        </category>
        <application>
          <member>any</member>
        </application>
        <service>
          <member>application-default</member>
        </service>
        <hip-profiles>
          <member>any</member>
        </hip-profiles>
        <action>allow</action>
        <log-setting>Mobile_Users_Log_Profile</log-setting>
      </entry>
      <entry name="MU-trust-to-trust">
        <profile-setting>
          <profiles>
            <url-filtering>
              <member>default</member>
            </url-filtering>
            <file-blocking>
              <member>basic file blocking</member>
            </file-blocking>
            <virus>
              <member>default</member>
            </virus>
            <spyware>
              <member>default</member>
            </spyware>
            <vulnerability>
              <member>default</member>
            </vulnerability>
            <wildfire-analysis>
              <member>default</member>
            </wildfire-analysis>
          </profiles>
        </profile-setting>
        <target>
          <negate>no</negate>
        </target>
        <to>
          <member>MU-trust</member>
        </to>
        <from>
          <member>MU-trust</member>
        </from>
        <source>
          <member>any</member>
        </source>
        <destination>
          <member>any</member>
        </destination>
        <source-user>
          <member>any</member>
        </source-user>
        <category>
          <member>any</member>
        </category>
        <application>
          <member>any</member>
        </application>
        <service>
          <member>application-default</member>
        </service>
        <hip-profiles>
          <member>any</member>
        </hip-profiles>
        <action>allow</action>
        <log-setting>Mobile_Users_Log_Profile</log-setting>
      </entry>

# ---------------------------------------------------------------------
# end of snippets section